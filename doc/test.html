<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">

    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/systemjs/6.15.1/system.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<!--    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>-->
<!--    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>-->

</head>
<body>

<script type="module">

    const transform = (filename, code) => Babel.transform(code, {
            presets: ['react', 'typescript'],
            filename: filename,
            plugins: ['transform-modules-systemjs'],
        }).code;


    System.shouldFetch = function () { return true; };

    System.constructor.prototype.fetch = async url => {
        // console.log('args: ', args);

        const filename = url.split('/').pop();
        if (! filename.endsWith('.tsx')) {
            return fetch(url);
        }

        const response = await fetch(url);

        const code = transform(filename, await response.text());

        const modifiedResponse = new Response(code, {
            status: response.status,
            headers: {
                'Content-type': 'text/javascript',
            },
        });

        return Promise.resolve(modifiedResponse);
    };


</script>

<script type="systemjs-importmap">
    {
      "imports": {
        "react": "https://unpkg.com/react@18/umd/react.development.js",
        "react-dom": "https://unpkg.com/react-dom@18/umd/react-dom.development.js"
      }
    }
</script>

<script type="systemjs-module" src="index.tsx" ></script>

<!--<script>-->
<!--    const code = `-->
<!--  import { add } from './math.js';-->
<!--  console.log(add(2, 3));-->
<!--`;-->

<!--    const output = Babel.transform(code, {-->
<!--        presets: ['react'],-->
<!--        plugins: ['transform-modules-systemjs'],-->
<!--    }).code;-->

<!--    // console.log(output);-->
<!--    // eval(output);-->

<!--</script>-->

<div id="root">

</div>

</body>
</html>